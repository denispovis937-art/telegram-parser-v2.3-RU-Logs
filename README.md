# telegram-parser-v2.3

Инструмент на Python (Telethon) для парсинга пользователей из Telegram и инвайта их в целевой чат/группу/канал.
Проект ориентирован на работу с несколькими аккаунтами Telegram, ротацию сессий и аккуратную обработку ограничений.

## Назначение проекта

Проект позволяет:

- парсить пользователей из чатов/каналов:
  - по списку участников (если он доступен),
  - по сообщениям (если список участников скрыт);
- сохранять usernames и user_id в файлы;
- инвайтить собранных пользователей в выбранную цель;
- работать с несколькими Telegram-аккаунтами;
- вести учёт инвайтов и ошибок через SQLite (ledger);
- продолжать работу с места остановки.

## Структура проекта

project/
├── main.py                основной файл, меню и сценарии
├── defunc.py              вся логика парсинга, фильтрации и инвайта
├── options.txt            настройки проекта (api_id, api_hash и флаги)
├── usernames.txt          список собранных usernames
├── userids.txt            список собранных user_id
├── invite_ledger.db       SQLite база (история инвайтов и статистика)
├── app.log                лог работы
└── sessoins/              папка с Telegram-сессиями (.session)

Важно: все файлы сессий хранятся только в папке `sessoins/`.

## Требования

- Python 3.9 или выше
- Telegram-аккаунт (один или несколько)
- api_id и api_hash
- Установленная библиотека telethon

Поддерживаемые системы:
- Windows
- macOS
- Linux (в том числе VPS)

## Получение api_id и api_hash

1. Перейти на https://my.telegram.org
2. Авторизоваться по номеру телефона
3. Открыть раздел "API development tools"
4. Создать приложение (любые значения)
5. Сохранить api_id и api_hash

## Установка

### Установка зависимостей

Если есть requirements.txt:

pip install -r requirements.txt

Или минимально:

pip install telethon

На macOS/Linux может потребоваться:

pip3 install telethon

## Настройка

Файл options.txt хранит основные параметры проекта.
Через меню можно:

- задать api_id
- задать api_hash
- включить или отключить парсинг usernames
- включить или отключить парсинг user_id
- добавить Telegram-аккаунт (создать сессию)

## Запуск

Windows:
python main.py

macOS / Linux:
python3 main.py

После запуска появится меню:

1 - Настройки
2 - Парсинг участников (если список виден)
3 - Парсинг из сообщений
4 - Инвайт пользователей
5 - Выход

## Добавление Telegram-аккаунта

Путь:
Настройки → Добавить аккаунт

Процесс:
- ввод номера телефона
- ввод кода из Telegram
- при необходимости ввод пароля 2FA

После этого в папке `sessoins/` появится файл .session.
Один файл соответствует одному аккаунту.

## Парсинг участников (пункт 2)

Используется, если в источнике доступен список участников.

Процесс:
- выбор Telegram-сессии
- выбор источника (чат/группа/канал)
- сбор пользователей
- фильтрация
- сохранение результатов в usernames.txt и/или userids.txt

## Парсинг из сообщений (пункт 3)

Используется, если список участников скрыт.

Процесс:
- выбор Telegram-сессии
- выбор источника
- указание количества сообщений для анализа
- указание максимального возраста сообщений
- сбор авторов сообщений
- фильтрация и сохранение результатов

## Фильтр качества пользователей

Используется жёсткий фильтр, который исключает:

- ботов
- удалённые аккаунты
- аккаунты без username
- аккаунты без фотографии
- неактивные аккаунты

Фильтр сделан для получения максимально качественной базы.

## Инвайт пользователей (пункт 4)

Инвайт выполняется из файлов usernames.txt и userids.txt.

Поддерживается:

- инвайт с одного аккаунта;
- инвайт с ротацией нескольких аккаунтов;
- автоматические паузы и антифлуд;
- продолжение с места остановки.

## Invite Ledger (invite_ledger.db)

SQLite база используется для:

- хранения истории инвайтов;
- предотвращения повторных попыток;
- учёта ошибок;
- заморозки аккаунтов при ограничениях.

Основные сущности:
- invites — история инвайтов по пользователям и целям;
- session_stats — статистика и ограничения по сессиям;
- excluded_users — пользователи, исключённые из обработки.

## Логи

Все действия записываются в файл app.log.
Рекомендуется смотреть лог при любой непонятной ситуации.

## Возможные проблемы

- FloodWait / PeerFlood — ограничения Telegram, решаются паузами и ротацией сессий.
- Сессия не авторизована — требуется повторный логин аккаунта.
- Нет доступа к цели — аккаунт должен быть участником целевого чата.

## Ответственное использование

Инструмент автоматизирует действия Telegram-аккаунтов.
Использовать аккуратно, с задержками и пониманием рисков ограничений.

## Функции проекта

- управление Telegram-сессиями
- парсинг участников
- парсинг из сообщений
- фильтрация пользователей
- инвайт в цель
- ротация аккаунтов
- антифлуд и паузы
- SQLite ledger
- логирование

Проект предназначен для технического использования и дальнейшего развития.
